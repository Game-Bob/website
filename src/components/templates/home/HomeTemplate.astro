---
import GameBobLayout from "../../../layouts/GameBobLayout.astro";
import { Icon } from "astro-icon/components";
import GameBobLogo from "../../../components/GameBobLogo.astro";
import ProjectHomeCard from "../../../components/gamebob/ProjectHomeCard.astro";
import DiscordCTA from "../../../components/gamebob/DiscordCTA.astro";
import { apps } from "../../../data/gamebob/apps";
import { useTranslations, useLanguagePath } from "../../../i18n/utils";
import "./HomeTemplate.css";

interface Props {
  lang: string;
}

const { lang } = Astro.props;
const t = useTranslations(lang as any);
const l = useLanguagePath(lang as any);
const featuredProject = apps[0];
const games = apps.filter(app => app.isGame && app.slug !== featuredProject.slug);
const utilities = apps.filter(app => !app.isGame && app.slug !== featuredProject.slug);
---

<GameBobLayout
    title={t("site.title")}
    description={t("site.description")}
    image="/images/gamebob/index.webp"
>
    <div class="gamebob-home">
        <header class="hero-header animate-box">
            <div class="header-content">
                <div class="logo-main">
                    <GameBobLogo />
                </div>
                <div class="header-text">
                    <h1 class="main-title">
                        GAME<span class="accent-text">BOB</span>
                    </h1>
                    <div class="status-line">
                        <span class="status-dot"></span>
                        <span class="status-text">{t("home.tagline")}</span>
                    </div>
                </div>
            </div>
            
            <div class="hero-actions">
                <DiscordCTA 
                    title={t("hero.discord.title")} 
                    subtitle={t("hero.discord.subtitle")}
                />
            </div>
        </header>

        <main class="dashboard-grid">
            
            <!-- Featured Project Section -->
            <section class="featured-section">
                <div class="section-header">
                     <h2 class="cyber-title">
                        <span class="bracket">[</span>
                        {t("home.sections.featured")}
                        <span class="bracket">]</span>
                    </h2>
                    <div class="title-line"></div>
                </div>
                
                <div class="featured-project-wrapper">
                    <ProjectHomeCard project={featuredProject} index={0} />
                </div>
            </section>

            <!-- Quick Games Preview -->
            <section class="games-preview-section">
                <div class="section-header">
                    <h2 class="cyber-title">
                        <span class="bracket">[</span>
                        {t("home.sections.more_games")}
                        <span class="bracket">]</span>
                    </h2>
                    <div class="title-line"></div>
                    <a href={l("/games/")} class="view-all-link">
                        {t("home.games.view_all")} <Icon name="mdi:arrow-right" />
                    </a>
                </div>

                <div class="project-list compact">
                    {
                        games.slice(0, 2).map((project: any, index: number) => (
                            <ProjectHomeCard project={project} index={index + 1} />
                        ))
                    }
                </div>
            </section>

            <!-- Utilities Section -->
            {utilities.length > 0 && (
                <section class="utilities-section">
                    <div class="section-header">
                        <h2 class="cyber-title">
                            <span class="bracket">[</span>
                            {t("home.sections.utilities")}
                            <span class="bracket">]</span>
                        </h2>
                        <div class="title-line"></div>
                    </div>

                    <div class="project-list compact">
                        {
                            utilities.map((project: any, index: number) => (
                                <ProjectHomeCard project={project} index={index} />
                            ))
                        }
                    </div>
                </section>
            )}

            <!-- Resources / Explore Section -->
            <section class="explore-section">
                <div class="section-header">
                    <h2 class="cyber-title">
                        <span class="bracket">[</span>
                        {t("home.sections.explore")}
                        <span class="bracket">]</span>
                    </h2>
                    <div class="title-line"></div>
                </div>

                <div class="resources-grid">
                    <section class="feature-panel green">
                        <div class="panel-header">
                            <Icon name="mdi:map-marker-path" class="panel-icon" />
                            <h3>{t("home.sections.roadmap")}</h3>
                        </div>
                        <div class="panel-body">
                            <h4>{t("home.features.roadmap.title")}{t("home.features.roadmap.titleAccent")}</h4>
                            <p>{t("home.features.roadmap.description")}</p>
                            <a href={l("/roadmap/")} class="panel-link">
                                {t("nav.roadmap")}
                                <Icon name="mdi:arrow-right" />
                            </a>
                        </div>
                    </section>

                    <section class="feature-panel blue">
                        <div class="panel-header">
                            <Icon name="mdi:code-braces" class="panel-icon" />
                            <h3>{t("home.sections.mechanics")}</h3>
                        </div>
                        <div class="panel-body">
                            <h4>{t("home.features.lab.title")}{t("home.features.lab.titleAccent")}</h4>
                            <p>{t("home.features.lab.description")}</p>
                            <a href={l("/mechanics/")} class="panel-link">
                                {t("nav.mechanics")}
                                <Icon name="mdi:arrow-right" />
                            </a>
                        </div>
                    </section>

                    <section class="feature-panel red">
                        <div class="panel-header">
                            <Icon name="mdi:skull-scan-outline" class="panel-icon" />
                            <h3>{t("home.sections.postmortem")}</h3>
                        </div>
                        <div class="panel-body">
                            <h4>{t("home.features.postmortem.title")}{t("home.features.postmortem.titleAccent")}</h4>
                            <p>{t("home.features.postmortem.description")}</p>
                            <a href={l("/postmortem/")} class="panel-link">
                                {t("nav.postmortem")}
                                <Icon name="mdi:arrow-right" />
                            </a>
                        </div>
                    </section>
                </div>
            </section>
        </main>
    </div>
</GameBobLayout>
