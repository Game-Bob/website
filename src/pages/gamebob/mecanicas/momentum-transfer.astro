---
export const prerender = true;
import MechanicPage from "../../../components/gamebob/mechanics/MechanicPage.astro";
import MechanicCanvas from "../../../components/gamebob/mechanics/MechanicCanvas.astro";
import MechanicInfo from "../../../components/gamebob/mechanics/MechanicInfo.astro";
import { Icon } from "astro-icon/components";

const GITHUB_BASE =
    "https://github.com/Game-Bob/website/tree/main/src/mechanics/momentum-transfer";
const CODE_URL =
    "https://github.com/Game-Bob/website/blob/main/src/mechanics/momentum-transfer/MomentumTransferGame.ts";
---

<MechanicPage
    title="Momentum Transfer"
    description="No matas enemigos golpeándolos, sino transfiriéndoles tu velocidad."
    githubUrl={GITHUB_BASE}
    codeurl={CODE_URL}

    image="/images/gamebob/mechanics/momentum-transfer.svg"
>
    <Icon slot="icon" name="mdi:billiards" style="color: var(--color-primary)" />

    <div style="max-width: 80rem; margin: 0 auto; padding: 2.5rem 1.5rem; display: flex; flex-direction: column; gap: var(--space-2xl);">
        <div style="position: relative;">
            <div style="display: flex; flex-direction: column; background: var(--bg-main); border-radius: var(--radius-3xl); overflow: hidden; border: 1px solid var(--white-10); box-shadow: 0 50px 100px -30px var(--black-90);">
                <div style="position: relative; background: var(--bg-main);">
                    <MechanicCanvas
                        id="game-canvas"
                        instruction="Tú eres la bola AZUL"
                        subInstruction="Golpea a los NARANJAS hacia los PINCHOS o VACÍO"
                        verticalOnMobile={true}

                    />
                </div>
            </div>
        </div>
    </div>

    <MechanicInfo>
        <Fragment slot="how-it-works">
            <li>
                <span style="color: var(--color-primary)">•</span>
                <span>Arrastra el mouse para lanzar al jugador.</span>
            </li>
            <li>
                <span style="color: var(--color-primary)">•</span>
                <span>Choca contra enemigos para transferirles tu velocidad y detenerte en seco.</span>
            </li>
            <li>
                <span style="color: var(--color-primary)">•</span>
                <span>Empuja a los enemigos hacia los pinchos o el vacío para eliminarlos.</span>
            </li>
        </Fragment>

        <Fragment slot="controls">
             <div class="control-item" style="grid-column: span 2;">
                <span class="control-key">Click & Drag</span>
                <span class="control-desc">Lanzar Jugador</span>
            </div>
        </Fragment>
    </MechanicInfo>
</MechanicPage>

<style is:global>
    
    .canvas-wrapper {
        width: 100%;
        max-width: 1100px;
        margin: 0 auto;
        aspect-ratio: 1600 / 1200;
        background: var(--bg-main);
    }

    #game-canvas {
        width: 100% !important;
        height: 100% !important;
        display: block;
        image-rendering: crisp-edges;
        cursor: crosshair;
        object-fit: contain;
    }

</style>

<script>
    import { MomentumTransferGame } from "../../../mechanics/momentum-transfer/MomentumTransferGame";

    const canvas = document.getElementById("game-canvas") as HTMLCanvasElement;
    const overlay = document.getElementById("game-canvas-overlay");

    let game: game | null = null;

    if (canvas && overlay) {
        canvas.width = 1600;
        canvas.height = 1200;

        overlay.addEventListener("click", () => {
            overlay.style.opacity = "0";
            overlay.style.pointerEvents = "none";

            if (!game) {
                game = new MomentumTransferGame(canvas);
                game.start();
            }
        });
    }
</script>
