---
import MechanicPage from "../../../components/gamebob/mechanics/MechanicPage.astro";
import { mechanics } from "../../../data/gamebob/mechanics";
import { ui, type SupportedLang } from "../../../i18n/ui";
import { useTranslations } from "../../../i18n/utils";

export async function getStaticPaths() {
  const paths = [];

  for (const lang of Object.keys(ui)) {
    for (const mechanic of mechanics) {
        const parts = mechanic.url.split('/').filter(Boolean);
        const slug = parts[parts.length - 1];
        if (slug) {
            paths.push({
                params: { lang, slug },
                props: { mechanic }
            });
        }
    }
  }

  return paths;
}

const { slug, lang } = Astro.params;
const { mechanic } = Astro.props;
const t = useTranslations(lang as SupportedLang);

const title = t(`mechanics.${mechanic.id}.title`);
const description = t(`mechanics.${mechanic.id}.description`);
---

<MechanicPage
    title={title}
    description={description}
    githubUrl={mechanic.githubUrl}
    codeUrl={mechanic.codeUrl}
    image={`/images/gamebob/mechanics/${slug}.webp`}
    lang={lang}
>
    <div style="padding: 2rem; text-align: center; color: var(--text-muted);">
        <h2>{t("mechanics.demoTitle")} {title}</h2>
        <p>{t("mechanics.demoDescription")} {slug}</p>
        <p>{t("mechanics.demoPlaceholder")}</p>
    </div>
</MechanicPage>
