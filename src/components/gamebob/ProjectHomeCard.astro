---
import './ProjectHomeCard.css';
import { Icon } from "astro-icon/components";
import type { Project } from "../../data/gamebob/roadmap/types";

interface Props {
    project: any;
    index: number;
}

const { project, index } = Astro.props;

const name = "name" in project ? project.name : project.title;
const homeDescription = "homeDescription" in project ? project.homeDescription : project.description;
const image = "media" in project ? project.media.showcase : project.image;
const statusLabel = "roadmap" in project ? project.roadmap.statusLabel : (project.statusLabel || project.statuslabel || "");
const statusType = "roadmap" in project ? project.roadmap.statusType : (project.statusType || project.statustype || "released");
const color = "theme" in project ? project.theme.primary : (project.color || "var(--color-primary)");

const links = "stores" in project
    ? {
          googlePlay: project.stores.googlePlay || project.stores.googleplay,
          appStore: project.stores.appStore || project.stores.appstore,
      }
    : project.links;

const isEven = index % 2 === 0;
const nameParts = name ? (name.includes(":") ? [name.split(":")[0], name.split(":")[1]] : [name, ""]) : ["", ""];

---

<div class="project-card">
    <div class:list={["project-card-content", { "order-right": !isEven }]}>
        <h3 class="project-card-title">
            <span class="title-main">{nameParts[0]}</span>
            {nameParts[1] && <span class="title-sub" style={`color: ${color}`}>{nameParts[1].trim()}</span>}
        </h3>
        <p class="project-card-description">
            {homeDescription}
        </p>

        <div class="project-status-container">
            <div class:list={[
                    "status-badge",
                    statusType,
                    { "pulse": statusType !== "released" },
                ]}
            >
                {statusLabel}
            </div>
        </div>

        <div class="project-links">
            {
                links?.googlePlay ? (
                    <a
                        href={links.googlePlay}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="store-button"
                    >
                        <Icon name="mdi:google-play" class="icon-6" />
                        <div class="button-stack">
                            <div class="button-stack-top">DISPONIBLE EN</div>
                            <div class="button-stack-main">Google Play</div>
                        </div>
                    </a>
                ) : (
                    <div class="store-button store-button-disabled">
                        <Icon name="mdi:google-play" class="icon-6" />
                        <div class="button-stack">
                            <div class="button-stack-top">próximamente en</div>
                            <div class="button-stack-main">google play</div>
                        </div>
                    </div>
                )
            }

            <button
                class="store-button store-button-disabled"
                title="Próximamente en App Store"
            >
                <Icon name="mdi:apple" class="icon-6" />
                <div class="button-stack">
                    <div class="button-stack-top">descárgalo en el</div>
                    <div class="button-stack-main">app store</div>
                </div>
            </button>
        </div>
    </div>

    <div
        class:list={[
            "image-wrapper",
            { "order-left": isEven },
        ]}
        style={`box-shadow: 0 25px 50px -12px ${color}33`}
    >
        <div class="image-container">
            {
                image ? (
                    <img
                        src={image}
                        alt={`${name} Cover`}
                        class="project-image"
                    />
                ) : (
                    <div class="image-placeholder">
                        {name}
                    </div>
                )
            }
            <div
                class="gradient-overlay"
                style={`background-image: linear-gradient(to bottom right, ${color}33, transparent)`}
            >
            </div>
            <div class="bottom-overlay">
            </div>
        </div>
    </div>
</div>
